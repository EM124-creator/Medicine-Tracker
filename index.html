<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Ù‡Ù†Ø§ ÙƒÙ„ CSS Ø§Ù„Ø³Ø§Ø¨Ù‚ (Ù†ÙØ³Ù‡ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±) */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', 'Cairo', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; direction: rtl; }
        body.dark-mode { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); }
        /* ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù€ CSS ÙƒÙ…Ø§ Ù‡Ùˆ ØªÙ…Ø§Ù…Ø§Ù‹ ... */
    </style>
</head>
<body>
    <!-- ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ© -->
    <div class="language-switcher" id="languageSwitcher">
        <button class="lang-btn" onclick="window.Translator?.setLanguage('ar')">
            <i class="fas fa-language"></i> Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
        </button>
        <button class="lang-btn" onclick="window.Translator?.setLanguage('en')">
            <i class="fas fa-language"></i> English
        </button>
    </div>

    <!-- ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù… (Ù„Ù„Ù…Ø¯ÙŠØ±) -->
    <div class="page admin-page" id="adminPage">
        <div class="container">
            <div class="header">
                <div class="user-controls">
                    <button class="theme-toggle" onclick="window.toggleTheme?.()">ğŸŒ™</button>
                    <button class="logout-btn" onclick="window.logout?.()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
                <h1 data-translate="adminDashboard"><i class="fas fa-user-shield"></i> Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ±</h1>
                <p class="subtitle" data-translate="manageUsers">Ø¥Ø¯Ø§Ø±Ø© Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>
                <div class="current-date" id="currentDate"></div>
            </div>
            <div class="user-list" id="adminUserList"></div>
        </div>
    </div>

    <!-- ØµÙØ­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="page user-page" id="userPage">
        <div class="container">
            <div class="header">
                <div class="user-controls">
                    <button class="theme-toggle" onclick="window.toggleTheme?.()">ğŸŒ™</button>
                    <button class="logout-btn" onclick="window.logout?.()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
                <h1 data-translate="appTitle"><i class="fas fa-pills"></i> Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h1>
                <p class="subtitle" data-translate="appSubtitle">Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¯ÙˆÙŠØªÙƒ ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø¬Ø±Ø¹Ø§ØªÙƒ Ø¨Ø¯Ù‚Ø©</p>
                <div class="current-date" id="currentDate"></div>
            </div>

            <div class="user-info" id="userInfo"></div>

            <!-- Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
            <div class="notifications-panel" id="notificationsPanel">
                <h2 class="section-title">
                    <i class="fas fa-bell"></i> <span data-translate="notificationManagement">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</span>
                </h2>
                <div class="notification-settings" id="notificationSettings"></div>
            </div>

            <div class="main-controls">
                <button class="btn btn-primary" onclick="window.openAddMedicationModal?.()" data-translate="addMedication">
                    <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ§Ø¡ Ø¬Ø¯ÙŠØ¯
                </button>
                <button class="btn btn-info" onclick="window.openSchedulePage?.()" data-translate="viewSchedule">
                    <i class="fas fa-calendar-alt"></i> Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                </button>
                <button class="btn btn-warning" onclick="window.printSchedule?.()" data-translate="printSchedule">
                    <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„
                </button>
            </div>

            <div class="medications-list">
                <h2 class="section-title">
                    <i class="fas fa-list"></i> <span data-translate="medicationList">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¯ÙˆÙŠØ©</span>
                </h2>
                <div id="medicationsList"></div>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© -->
    <div class="modal" id="medicationModal">
        <div class="modal-content">
            <div class="modal-header" id="modalTitle">
                <i class="fas fa-plus-circle"></i> Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ§Ø¡ Ø¬Ø¯ÙŠØ¯
            </div>
            <div class="form-group">
                <label class="form-label" data-translate="medicationName">Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡</label>
                <input type="text" class="form-input" id="medName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡">
            </div>
            <!-- ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„ ... -->
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="window.saveMedication?.()" data-translate="save">Ø­ÙØ¸</button>
                <button class="btn btn-secondary" onclick="window.closeModal?.('medicationModal')" data-translate="cancel">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK (Ù…Ù†ÙØµÙ„Ø© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹) -->
    <script>
        // Load Firebase first, then other scripts
        window.firebaseLoaded = false;
        
        function loadFirebase() {
            if (!window.firebaseLoaded) {
                const script1 = document.createElement('script');
                script1.src = 'https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js';
                script1.onload = function() {
                    const script2 = document.createElement('script');
                    script2.src = 'https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js';
                    script2.onload = function() {
                        const script3 = document.createElement('script');
                        script3.src = 'https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js';
                        script3.onload = function() {
                            window.firebaseLoaded = true;
                            initializeFirebase();
                            loadOtherScripts();
                        };
                        document.head.appendChild(script3);
                    };
                    document.head.appendChild(script2);
                };
                document.head.appendChild(script1);
            }
        }
        
        function initializeFirebase() {
            // ===== ØªÙƒÙˆÙŠÙ† Firebase =====
            const firebaseConfig = {
                apiKey: "AIzaSyBAcSevspk9_fK4jC1ZkLRhRMNqG9Pv5mU",
                authDomain: "medicine-tracker-a8955.firebaseapp.com",
                databaseURL: "https://medicine-tracker-a8955-default-rtdb.firebaseio.com",
                projectId: "medicine-tracker-a8955",
                storageBucket: "medicine-tracker-a8955.firebasestorage.app",
                messagingSenderId: "507688371470",
                appId: "1:507688371470:web:e65375310a82e5ba83435f",
                measurementId: "G-SK8M4BFT6Q"
            };

            // ØªÙ‡ÙŠØ¦Ø© Firebase Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
            if (typeof firebase !== 'undefined' && !firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
                console.log('Firebase initialized successfully');
            }
        }
        
        function loadOtherScripts() {
            // Load Toastify
            const toastify = document.createElement('script');
            toastify.src = 'https://cdn.jsdelivr.net/npm/toastify-js';
            document.head.appendChild(toastify);
            
            // Load our scripts in order
            const scripts = [
                'translation.js',
                'firebase-db.js',
                'auth-system.js',
                'app-core.js'
            ];
            
            function loadScript(index) {
                if (index < scripts.length) {
                    const script = document.createElement('script');
                    script.src = scripts[index];
                    script.onload = function() {
                        console.log('Loaded:', scripts[index]);
                        loadScript(index + 1);
                    };
                    script.onerror = function() {
                        console.error('Failed to load:', scripts[index]);
                        loadScript(index + 1);
                    };
                    document.head.appendChild(script);
                } else {
                    // All scripts loaded, initialize app
                    if (window.MedicationApp) {
                        window.MedicationApp.init();
                    }
                }
            }
            
            loadScript(0);
        }
        
        // Start loading process
        window.addEventListener('DOMContentLoaded', loadFirebase);
    </script>
</body>
</html>
